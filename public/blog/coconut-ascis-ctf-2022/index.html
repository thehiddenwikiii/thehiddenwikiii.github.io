<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"><head>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title>Coconut - ASCIS CTF 2022 &middot; Home</title>
    <meta name="title" content="Coconut - ASCIS CTF 2022 &middot; Home">
  

  
  
  
    <meta name="keywords" content="Obfuscation,ascis,">
  
  
  
  <link rel="canonical" href="https://thehiddenwikiii.github.io/blog/coconut-ascis-ctf-2022/">
  

  
  
    <meta name="author" content="MrEn1gma">
  
  
    
      
        
          <link href="https://facebook.com/en1gmalware" rel="me">
        
      
    
      
        
          <link href="https://x.com/en1gmalware" rel="me">
        
      
    
  

  
  <meta property="og:url" content="https://thehiddenwikiii.github.io/blog/coconut-ascis-ctf-2022/">
  <meta property="og:site_name" content="Home">
  <meta property="og:title" content="Coconut - ASCIS CTF 2022">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2022-10-19T20:00:00+07:00">
    <meta property="article:modified_time" content="2022-10-19T20:00:00+07:00">
    <meta property="article:tag" content="Obfuscation">
    <meta property="article:tag" content="Ascis">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Coconut - ASCIS CTF 2022">

  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
  
    
  

  
  
  
  
  
  

  

  
  
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.39e41cf6262980d0e7955c6ab1750effed70b4c10b8a77b38c609447c4e1c41d8498cc76fafba2c8c31f908da5166dc8c7cb53a2767986f77ce01123a691a7db.css"
    integrity="sha512-OeQc9iYpgNDnlVxqsXUO/&#43;1wtMELinezjGCUR8ThxB2EmMx2&#43;vuiyMMfkI2lFm3Ix8tTonZ5hvd84BEjppGn2w==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js"
    integrity="sha512-b0EXSzoFtoCCD&#43;CMrb&#43;l&#43;3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.b4b722fcb5d42f34f52b30a92f3521b69f403ca9d96d0d6179eb537cb870f5d83fdf1fe836688d95d5c99fefbda4170487711006e56051fa67ea00da10521721.js" integrity="sha512-tLci/LXULzT1KzCpLzUhtp9APKnZbQ1heetTfLhw9dg/3x/oNmiNldXJn&#43;&#43;9pBcEh3EQBuVgUfpn6gDaEFIXIQ=="></script>
  

  
  
  
    
  
  
    
  
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.8a7555fb423a0116a6dfa29093ec064f6ef1dc1ed9bb6a3f506aac690ff36a61a4c7701da737740aba22c3187ec6e42cbf3b20c0f1d4abebf0e8c1b5b0ded7b5.js"
      integrity="sha512-inVV&#43;0I6ARam36KQk&#43;wGT27x3B7Zu2o/UGqsaQ/zamGkx3Adpzd0Croiwxh&#43;xuQsvzsgwPHUq&#43;vw6MG1sN7XtQ=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  

<script src="/lib/jquery/jquery.slim.min.03cb160e3cfdb2667a2e2c80d283bebcf63ff8bbc4b629c9ab2babf6fae1d0c07ad470edae783efa4fabda2ac01c58d60e63b98b3c336be8208460f08f4354f5.js" integrity="sha512-A8sWDjz9smZ6LiyA0oO&#43;vPY/&#43;LvEtinJqyur9vrh0MB61HDtrng&#43;&#43;k&#43;r2irAHFjWDmO5izwza&#43;gghGDwj0NU9Q=="></script>


























  

  

  

  

  








  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Blogs",
    "name": "Coconut - ASCIS CTF 2022",
    "headline": "Coconut - ASCIS CTF 2022",
    
    "inLanguage": "en",
    "url" : "https://thehiddenwikiii.github.io/blog/coconut-ascis-ctf-2022/",
    "author" : {
      "@type": "Person",
      "name": "MrEn1gma"
    },
    "copyrightYear": "2022",
    "dateCreated": "2022-10-19T20:00:00\u002b07:00",
    "datePublished": "2022-10-19T20:00:00\u002b07:00",
    
    "dateModified": "2022-10-19T20:00:00\u002b07:00",
    
    "keywords": ["Obfuscation","ascis"],
    
    "mainEntityOfPage": "true",
    "wordCount": "1565"
  }]
  </script>



  
  
    




  

  
  

  
  

  
  

  
  
</head>







  
    
  







  
    
  






  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      <div class="main-menu flex items-center w-full gap-2 p-1 pl-0">
  
  
    <a href="/" class="text-base font-medium truncate min-w-0 shrink">
      Home
    </a>
  
  <div class="flex items-center ms-auto">
    <div class="hidden md:flex">
      <nav class="flex items-center gap-x-5 h-12">
  
    
      
  
    <a
      href="/blog/"
      
      class="flex items-center bf-icon-color-hover"
      aria-label="Blog"
      title="Blogs">
      
      
        <span class="text-base font-medium break-normal">
          Blog
        </span>
      
    </a>
  

    
  

  

  

  
    <button
      id="search-button"
      aria-label="Search"
      class="text-base bf-icon-color-hover"
      title="Search (/)">
      <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
    </button>
  

  
    <div class="flex items-center">
      <button
        id="appearance-switcher"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base bf-icon-color-hover">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    </div>
  
</nav>



    </div>
    <div class="flex md:hidden">
      <div class="flex items-center h-14 gap-4">
  
    <button
      id="search-button-mobile"
      aria-label="Search"
      class="flex items-center justify-center bf-icon-color-hover"
      title="Search (/)">
      <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
    </button>
  

  
    <button
      id="appearance-switcher-mobile"
      type="button"
      aria-label="Dark mode switcher"
      class="flex items-center justify-center text-neutral-900 hover:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400">
      <div class="dark:hidden">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
      </div>
      <div class="hidden dark:block">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
      </div>
    </button>
  

  
    <input type="checkbox" id="mobile-menu-toggle" autocomplete="off" class="hidden peer">
    <label for="mobile-menu-toggle" class="flex items-center justify-center cursor-pointer bf-icon-color-hover">
      <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
    </label>

    <div
      role="dialog"
      aria-modal="true"
      style="scrollbar-gutter: stable;"
      class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
      bf-scrollbar">
      <label
        for="mobile-menu-toggle"
        class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </label>
      <nav class="mx-auto max-w-md space-y-6">
        
  
    
    <div class="px-2">
      <a
        href="/blog/"
        aria-label="Blog"
        
        class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
        
        <span title="Blogs" class="text-2xl font-bold tracking-tight">
          Blog
        </span>
        
      </a>

      
    </div>
  

        
  

        
  

      </nav>
    </div>
  
</div>







    </div>
  </div>
</div>





    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    
      
      
      
      
        







  
  
    
  
    
  
    
  
    
  



  
  
    
    
  




  
    
    
      
      
    
  





    <div id="hero" class="h-[150px] md:h-[200px]"></div>
  
  <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom">
    
    
    
    <img
      id="background-image"
      src="/img/background_hu_acc5acef28ae0b44.jpg"
      role="presentation"
      loading="eager"
      decoding="async"
      fetchpriority="high"
      class="absolute inset-0 w-full h-full object-cover"
      >
    <div
      class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div>
    <div
      class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div>
  </div>

  
    <div
      id="background-blur"
      class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-xl bg-neutral-100/75 dark:bg-neutral-800/60"></div>
    
    
    <script
      type="text/javascript"
      src="/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js"
      integrity="sha512-AKV8c&#43;oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ&#43;pkPSYl5ixQYmehaQ=="
      data-blur-id="background-blur"
      data-image-id="background-image"
      data-image-url="/img/background_hu_acc5acef28ae0b44.jpg"></script>
  
      
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Coconut - ASCIS CTF 2022
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2022-10-19T20:00:00&#43;07:00">19 October 2022</time><span class="px-2 text-primary-500">&middot;</span><span>1565 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">8 mins</span>
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  
    
    
<div class="flex author">
  
    
    
      
    
    
      
      
      
        
        
        
      
      <img
        class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4"
        width="96"
        height="96"
        alt="MrEn1gma"
        src="/img/avatar_hu_eba9a093b258db11.jpg"
        data-zoom-src="/img/avatar_hu_be943a213a1f4902.jpg">
    
  
  <div class="place-self-center">
    
      <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        Author
      </div>
      <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        MrEn1gma
      </div>
    
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://facebook.com/en1gmalware"
          target="_blank"
          aria-label="Facebook"
          title="Facebook"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
</span></span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://x.com/en1gmalware"
          target="_blank"
          aria-label="X-Twitter"
          title="X-Twitter"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a
        >
      
    
  </div>

</div>
  </div>
</div>

  

  

  
    <div class="mb-5"></div>
  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-10">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#giới-thiệu">Giới thiệu</a></li>
    <li><a href="#tổng-quan">Tổng quan</a></li>
    <li><a href="#deobfuscate">Deobfuscate</a></li>
    <li><a href="#phân-tích-coconutexe-patched">Phân tích coconut.exe (patched)</a></li>
    <li><a href="#bypass-the-time">Bypass the Time</a></li>
    <li><a href="#end">END</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#giới-thiệu">Giới thiệu</a></li>
    <li><a href="#tổng-quan">Tổng quan</a></li>
    <li><a href="#deobfuscate">Deobfuscate</a></li>
    <li><a href="#phân-tích-coconutexe-patched">Phân tích coconut.exe (patched)</a></li>
    <li><a href="#bypass-the-time">Bypass the Time</a></li>
    <li><a href="#end">END</a></li>
  </ul>
</nav>
  </div>
</details>



            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          
<h1 class="relative group">Lời nói đầu
    <div id="lời-nói-đầu" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#l%e1%bb%9di-n%c3%b3i-%c4%91%e1%ba%a7u" aria-label="Anchor">#</a>
    </span>
    
</h1>
<ul>
<li>
<p>Vòng loại giải Sinh Viên An Toàn Thông Tin ASEAN đã kết thúc vào ngày 15/10. Đó là ngày đáng nhớ của mình cũng như các bạn khác tham gia vào ngày hôm đó, team mình - <code>th++</code> đã cố gắng giành được giải Khuyến Khích. Cảm xúc của mình lúc đó có buồn, có vui. Nhưng ít nhất mình cũng đã tận hưởng những ngày tháng cùng đám bạn tham gia SVATTT với tư cách là sinh viên năm cuối ĐH.</p>
</li>
<li>
<p>Bài <code>coconut</code> mình đã không kịp giải ra vào thời điểm đó, nhưng mình đã cố gắng giải bài này và cuối cùng mình cũng đã hoàn thành. Trước khi đi vào phần writeup, mình xin cảm ơn em <code>@mochi753</code> và <code>@EaZyQ</code> đã hỗ trợ anh giải ra được bài đó.</p>
</li>
</ul>

<h2 class="relative group">Giới thiệu
    <div id="giới-thiệu" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#gi%e1%bb%9bi-thi%e1%bb%87u" aria-label="Anchor">#</a>
    </span>
    
</h2>
<ul>
<li><strong>Given files:</strong> <a href="https://github.com/MrEn1gma/Writeups/raw/main/ASCIS/2022/Coconut/Coconut.exe"  target="_blank">coconut.exe</a></li>
<li><strong>Category</strong>: Reversing</li>
<li><strong>Summary</strong>: Crackme được viết bằng c# và sử dụng kỹ thuật che giấu đi code thật (không rõ chi tiết cái technique đó), bằng việc decrypt toàn bộ các hàm bị obfuscation. Sau đó reverse lại cái Crypto đó, mình tìm được key của flag1, flag thứ 2 phụ thuộc vào stack frame để cho ra key đúng, từ đó mình tìm ra được flag còn lại.</li>
</ul>

<h2 class="relative group">Tổng quan
    <div id="tổng-quan" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#t%e1%bb%95ng-quan" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Nhìn tổng quan toàn bộ các hàm của binary, dễ dàng nhận ra rằng tất cả các hàm đều bị obfuscated, ngoại trừ hàm <code>coconut_10</code> là nơi lưu trữ các giá trị nhằm phục vụ cho việc deobfuscate sau khi crackme được thực thi.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">internal</span> <span class="k">class</span> <span class="nc">Program</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Token: 0x06000017 RID: 23 RVA: 0x00002FF4 File Offset: 0x000011F4</span>
</span></span><span class="line"><span class="cl">	<span class="kd">private</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">Coconut</span><span class="p">.</span><span class="n">coconut_10</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="n">Coconut</span><span class="p">.</span><span class="n">coconut_28</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="n">Coconut</span><span class="p">.</span><span class="n">coconut_25</span><span class="p">(</span><span class="n">Coconut</span><span class="p">.</span><span class="n">coconut_15</span><span class="p">(</span><span class="n">text</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">Coconut</span><span class="p">.</span><span class="n">coconut_46</span><span class="p">(</span><span class="n">text</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p>Phần <code>Deobfuscate</code> sẽ giải mã toàn bộ các hàm và tiếp tục phân tích.</p>

<h2 class="relative group">Deobfuscate
    <div id="deobfuscate" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#deobfuscate" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Mình lấy hàm <code>coconut_28</code> làm ví dụ: hàm này sử dụng để giải mã cái hàm <code>coconut_82</code>, nhưng do hàm <code>coconut_82</code> chưa được dnSpy nhận diện là 1 hàm, nên nó sẽ nhảy tới hàm <code>coconut_25</code> để decode. Để ý là có <code>coconut_meat28</code> và <code>coconut_water28</code> được load vào.</p>
<p>Hàm <code>coconut_25</code>:</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">object</span> <span class="n">coconut_25</span><span class="p">(</span><span class="n">InvalidProgramException</span> <span class="n">e</span><span class="p">,</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">args</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">uint</span><span class="p">,</span> <span class="kt">int</span><span class="p">&gt;</span> <span class="n">m</span><span class="p">,</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">metadataToken</span> <span class="p">=</span> <span class="k">new</span> <span class="n">StackTrace</span><span class="p">(</span><span class="n">e</span><span class="p">).</span><span class="n">GetFrame</span><span class="p">(</span><span class="m">0</span><span class="p">).</span><span class="n">GetMethod</span><span class="p">().</span><span class="n">MetadataToken</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">Module</span> <span class="n">module</span> <span class="p">=</span> <span class="k">typeof</span><span class="p">(</span><span class="n">Program</span><span class="p">).</span><span class="n">Module</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">MethodInfo</span> <span class="n">methodInfo</span> <span class="p">=</span> <span class="p">(</span><span class="n">MethodInfo</span><span class="p">)</span><span class="n">module</span><span class="p">.</span><span class="n">ResolveMethod</span><span class="p">(</span><span class="n">metadataToken</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">MethodBase</span> <span class="n">methodBase</span> <span class="p">=</span> <span class="n">module</span><span class="p">.</span><span class="n">ResolveMethod</span><span class="p">(</span><span class="n">metadataToken</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">ParameterInfo</span><span class="p">[]</span> <span class="n">parameters</span> <span class="p">=</span> <span class="n">methodInfo</span><span class="p">.</span><span class="n">GetParameters</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="n">Type</span><span class="p">[]</span> <span class="n">array</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Type</span><span class="p">[</span><span class="n">parameters</span><span class="p">.</span><span class="n">Length</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="n">SignatureHelper</span> <span class="n">localVarSigHelper</span> <span class="p">=</span> <span class="n">SignatureHelper</span><span class="p">.</span><span class="n">GetLocalVarSigHelper</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">array</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">parameters</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ParameterType</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Type</span> <span class="n">declaringType</span> <span class="p">=</span> <span class="n">methodBase</span><span class="p">.</span><span class="n">DeclaringType</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">DynamicMethod</span> <span class="n">dynamicMethod</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DynamicMethod</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">,</span> <span class="n">methodInfo</span><span class="p">.</span><span class="n">ReturnType</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">declaringType</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">DynamicILInfo</span> <span class="n">dynamicILInfo</span> <span class="p">=</span> <span class="n">dynamicMethod</span><span class="p">.</span><span class="n">GetDynamicILInfo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="n">MethodBody</span> <span class="n">methodBody</span> <span class="p">=</span> <span class="n">methodInfo</span><span class="p">.</span><span class="n">GetMethodBody</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">foreach</span> <span class="p">(</span><span class="n">LocalVariableInfo</span> <span class="n">localVariableInfo</span> <span class="k">in</span> <span class="n">methodBody</span><span class="p">.</span><span class="n">LocalVariables</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">localVarSigHelper</span><span class="p">.</span><span class="n">AddArgument</span><span class="p">(</span><span class="n">localVariableInfo</span><span class="p">.</span><span class="n">LocalType</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">byte</span><span class="p">[]</span> <span class="n">signature</span> <span class="p">=</span> <span class="n">localVarSigHelper</span><span class="p">.</span><span class="n">GetSignature</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="n">dynamicILInfo</span><span class="p">.</span><span class="n">SetLocalSignature</span><span class="p">(</span><span class="n">signature</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">foreach</span> <span class="p">(</span><span class="n">KeyValuePair</span><span class="p">&lt;</span><span class="kt">uint</span><span class="p">,</span> <span class="kt">int</span><span class="p">&gt;</span> <span class="n">keyValuePair</span> <span class="k">in</span> <span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="k">value</span> <span class="p">=</span> <span class="n">keyValuePair</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kt">uint</span> <span class="n">key</span> <span class="p">=</span> <span class="n">keyValuePair</span><span class="p">.</span><span class="n">Key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">tokenFor</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="k">value</span> <span class="p">&gt;=</span> <span class="m">1879048192</span> <span class="p">&amp;&amp;</span> <span class="k">value</span> <span class="p">&lt;</span> <span class="m">1879113727</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">tokenFor</span> <span class="p">=</span> <span class="n">dynamicILInfo</span><span class="p">.</span><span class="n">GetTokenFor</span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">ResolveString</span><span class="p">(</span><span class="k">value</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">else</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">MemberInfo</span> <span class="n">memberInfo</span> <span class="p">=</span> <span class="n">declaringType</span><span class="p">.</span><span class="n">Module</span><span class="p">.</span><span class="n">ResolveMember</span><span class="p">(</span><span class="k">value</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="n">memberInfo</span><span class="p">.</span><span class="n">GetType</span><span class="p">().</span><span class="n">Name</span> <span class="p">==</span> <span class="s">&#34;RtFieldInfo&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">tokenFor</span> <span class="p">=</span> <span class="n">dynamicILInfo</span><span class="p">.</span><span class="n">GetTokenFor</span><span class="p">(((</span><span class="n">FieldInfo</span><span class="p">)</span><span class="n">memberInfo</span><span class="p">).</span><span class="n">FieldHandle</span><span class="p">,</span> <span class="p">((</span><span class="n">TypeInfo</span><span class="p">)((</span><span class="n">FieldInfo</span><span class="p">)</span><span class="n">memberInfo</span><span class="p">).</span><span class="n">DeclaringType</span><span class="p">).</span><span class="n">TypeHandle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">memberInfo</span><span class="p">.</span><span class="n">GetType</span><span class="p">().</span><span class="n">Name</span> <span class="p">==</span> <span class="s">&#34;RuntimeType&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">tokenFor</span> <span class="p">=</span> <span class="n">dynamicILInfo</span><span class="p">.</span><span class="n">GetTokenFor</span><span class="p">(((</span><span class="n">TypeInfo</span><span class="p">)</span><span class="n">memberInfo</span><span class="p">).</span><span class="n">TypeHandle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">memberInfo</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="s">&#34;.ctor&#34;</span> <span class="p">||</span> <span class="n">memberInfo</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="s">&#34;.cctor&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">tokenFor</span> <span class="p">=</span> <span class="n">dynamicILInfo</span><span class="p">.</span><span class="n">GetTokenFor</span><span class="p">(((</span><span class="n">ConstructorInfo</span><span class="p">)</span><span class="n">memberInfo</span><span class="p">).</span><span class="n">MethodHandle</span><span class="p">,</span> <span class="p">((</span><span class="n">TypeInfo</span><span class="p">)((</span><span class="n">ConstructorInfo</span><span class="p">)</span><span class="n">memberInfo</span><span class="p">).</span><span class="n">DeclaringType</span><span class="p">).</span><span class="n">TypeHandle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">else</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">tokenFor</span> <span class="p">=</span> <span class="n">dynamicILInfo</span><span class="p">.</span><span class="n">GetTokenFor</span><span class="p">(((</span><span class="n">MethodInfo</span><span class="p">)</span><span class="n">memberInfo</span><span class="p">).</span><span class="n">MethodHandle</span><span class="p">,</span> <span class="p">((</span><span class="n">TypeInfo</span><span class="p">)((</span><span class="n">MethodInfo</span><span class="p">)</span><span class="n">memberInfo</span><span class="p">).</span><span class="n">DeclaringType</span><span class="p">).</span><span class="n">TypeHandle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">b</span><span class="p">[(</span><span class="kt">int</span><span class="p">)</span><span class="n">key</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="n">tokenFor</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">b</span><span class="p">[(</span><span class="kt">int</span><span class="p">)(</span><span class="n">key</span> <span class="p">+</span> <span class="m">1</span><span class="n">U</span><span class="p">)]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">tokenFor</span> <span class="p">&gt;&gt;</span> <span class="m">8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">b</span><span class="p">[(</span><span class="kt">int</span><span class="p">)(</span><span class="n">key</span> <span class="p">+</span> <span class="m">2</span><span class="n">U</span><span class="p">)]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">tokenFor</span> <span class="p">&gt;&gt;</span> <span class="m">16</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">b</span><span class="p">[(</span><span class="kt">int</span><span class="p">)(</span><span class="n">key</span> <span class="p">+</span> <span class="m">3</span><span class="n">U</span><span class="p">)]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">tokenFor</span> <span class="p">&gt;&gt;</span> <span class="m">24</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">dynamicILInfo</span><span class="p">.</span><span class="n">SetCode</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">methodBody</span><span class="p">.</span><span class="n">MaxStackSize</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">dynamicMethod</span><span class="p">.</span><span class="n">Invoke</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="n">args</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p>MetadataToken thực hiện load token nhằm lấy data của hàm <code>coconut_82</code>, sau đó thực hiện vòng lặp để nạp vào các section và tiến hành giải mã các byte của hàm <code>coconut_82</code>, cuối cùng thực thi chúng bằng method <code>dynamicMethod.Invoke(null, args)</code>.</p>
<ul>
<li>
<p>metataToken:


  

<figure><img src="/blog/coconut-ascis-ctf-2022/ASCIScoconut_img/photo_2022-10-21_10-27-46.jpg"
    alt="Mô tả hình ảnh" width="1000">
</figure>

</p>
</li>
<li>
<p>Hàm giải mã:</p>
</li>
</ul>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">b</span><span class="p">[(</span><span class="kt">int</span><span class="p">)</span><span class="n">key</span><span class="p">]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="n">tokenFor</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span><span class="p">[(</span><span class="kt">int</span><span class="p">)(</span><span class="n">key</span> <span class="p">+</span> <span class="m">1</span><span class="n">U</span><span class="p">)]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">tokenFor</span> <span class="p">&gt;&gt;</span> <span class="m">8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span><span class="p">[(</span><span class="kt">int</span><span class="p">)(</span><span class="n">key</span> <span class="p">+</span> <span class="m">2</span><span class="n">U</span><span class="p">)]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">tokenFor</span> <span class="p">&gt;&gt;</span> <span class="m">16</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span><span class="p">[(</span><span class="kt">int</span><span class="p">)(</span><span class="n">key</span> <span class="p">+</span> <span class="m">3</span><span class="n">U</span><span class="p">)]</span> <span class="p">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">tokenFor</span> <span class="p">&gt;&gt;</span> <span class="m">24</span><span class="p">);</span></span></span></code></pre></div></div>
<p><strong>Nhận xét:</strong> hàm <code>coconut_25</code> chỉ thực hiện giải mã bằng cách dùng toán tử <code>shift right</code> lần lượt là 8, 16, 24, mình có thể viết script để thực hiện giải mã:</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">ASCIS_coconut_decrypt</span><span class="p">(</span><span class="n">meat</span><span class="p">,</span> <span class="n">water</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meat</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">water</span><span class="p">[</span><span class="n">meat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">meat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
</span></span><span class="line"><span class="cl">        <span class="n">water</span><span class="p">[</span><span class="n">meat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">meat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
</span></span><span class="line"><span class="cl">        <span class="n">water</span><span class="p">[</span><span class="n">meat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">meat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
</span></span><span class="line"><span class="cl">        <span class="n">water</span><span class="p">[</span><span class="n">meat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">meat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">water</span></span></span></code></pre></div></div>
<p>Sau đó sửa các byte dựa trên địa chỉ của <code>water</code> tương ứng với hàm cần giải mã, trong trường hợp ở đây là <code>water28</code> có địa chỉ là <code>0x7bc + 21</code> với 21 là size của <code>water28</code>.</p>
<p>NOTE: để tìm chính xác địa chỉ của <code>water28</code>, mình sử dụng chức năng <code>Show Instructions in Hex Editor</code>.</p>
<p>Full script mình để ở đây: <a href="https://github.com/MrEn1gma/Writeups/blob/1e22e7dfb687829b0fbf2713c22e0779922c4b8e/ASCIS/2022/Coconut/decrypt.py"  target="_blank">deobfuscate_coconut</a></p>

<h2 class="relative group">Phân tích coconut.exe (patched)
    <div id="phân-tích-coconutexe-patched" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#ph%c3%a2n-t%c3%adch-coconutexe-patched" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Sau khi decrypt xong, hàm <code>coconut_82</code> và các hàm khác đã được giải mã.</p>
<ul>
<li>Nhập key và read key.</li>
</ul>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">coconut_82</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="s">&#34;Enter key: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<ul>
<li>Hàm xử lý input</li>
</ul>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">coconut_51</span><span class="p">(</span><span class="kt">string</span> <span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">BitConverter</span><span class="p">.</span><span class="n">ToString</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">s</span><span class="p">)).</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;-&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p>Quan sát hàm <code>coconut_51</code>, mình nhận thấy nó thực hiện 2 bước để check. Đầu tiên chúng sẽ convert các ký tự ASCII sang chuỗi số thập lục phân và xoá các ký tự <code>-</code> để thành 1 chuỗi hexstring. Tiếp tục đi vào hàm <code>coconut_52</code> để thực hiện check key.</p>


  

<figure><img src="/blog/coconut-ascis-ctf-2022/ASCIScoconut_img/photo_2022-10-21_10-54-53.jpg"
    alt="Mô tả hình ảnh" width="1000">
</figure>


<ul>
<li>Hàm <code>coconut_52</code>:</li>
</ul>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">bool</span> <span class="n">coconut_52</span><span class="p">(</span><span class="kt">string</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">BigInteger</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">NumberStyles</span><span class="p">.</span><span class="n">HexNumber</span><span class="p">)</span> <span class="p">*</span> <span class="n">Coconut</span><span class="p">.</span><span class="n">coconut_89</span><span class="p">(</span><span class="n">Coconut</span><span class="p">.</span><span class="n">water_01</span><span class="p">)</span> <span class="p">%</span> <span class="n">Coconut</span><span class="p">.</span><span class="n">coconut_89</span><span class="p">(</span><span class="n">Coconut</span><span class="p">.</span><span class="n">water_02</span><span class="p">)</span> <span class="p">==</span> <span class="n">Coconut</span><span class="p">.</span><span class="n">coconut_89</span><span class="p">(</span><span class="n">Coconut</span><span class="p">.</span><span class="n">water_03</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="n">BigInteger</span> <span class="n">coconut_98</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">foreach</span> <span class="p">(</span><span class="kt">byte</span> <span class="n">b2</span> <span class="k">in</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="n">b2</span> <span class="p">&lt;</span> <span class="m">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">text</span> <span class="p">+=</span> <span class="p">((</span><span class="kt">char</span><span class="p">)(</span><span class="n">b2</span> <span class="p">+</span> <span class="m">48</span><span class="p">)).</span><span class="n">ToString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">else</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">text</span> <span class="p">+=</span> <span class="p">((</span><span class="kt">char</span><span class="p">)(</span><span class="n">b2</span> <span class="p">+</span> <span class="m">87</span><span class="p">)).</span><span class="n">ToString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">BigInteger</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">NumberStyles</span><span class="p">.</span><span class="n">HexNumber</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p>Quan sát hàm <code>coconut_98</code>, chúng sẽ load lần lượt các giá trị <code>Coconut.water_01</code>, <code>Coconut.water_02</code>, <code>Coconut.water_03</code> để tính toán ra các số nguyên lớn và sau khi input được convert sang chuỗi hexstring, method <code>BigInteger</code> trong hàm <code>coconut_52</code> prase chuỗi hexstring thành số nguyên lớn. Sau đó thực hiện tính toán để check key.</p>
<p><strong>Nhận xét:</strong> Một bài toán liên quan tới Crypto, tuy nhiên thì mình không đi sâu về phần giải thích mà chỉ đưa ra phần giải.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">-- PROBLEM --
</span></span><span class="line"><span class="cl">passwd * coconut_water01 % coconut_water02 = coconut_water03
</span></span><span class="line"><span class="cl">=&gt; passwd = (coconut_water03 * inverse(coconut_water01, coconut_water02)) % coconut_water02</span></span></code></pre></div></div>
<ul>
<li>Thực hiện bằng python script</li>
</ul>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">passwd</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">((</span><span class="n">ASCIS_coconut_52_BIGNUMBER</span><span class="p">(</span><span class="n">coconut_water03</span><span class="p">)</span> <span class="o">*</span> <span class="n">inverse</span><span class="p">(</span><span class="n">ASCIS_coconut_52_BIGNUMBER</span><span class="p">(</span><span class="n">coconut_water01</span><span class="p">),</span> <span class="n">ASCIS_coconut_52_BIGNUMBER</span><span class="p">(</span><span class="n">coconut_water02</span><span class="p">)))</span> <span class="o">%</span> <span class="n">ASCIS_coconut_52_BIGNUMBER</span><span class="p">(</span><span class="n">coconut_water02</span><span class="p">))</span></span></span></code></pre></div></div>
<p>Chạy file script trên, mình đã tìm ra được key: <code>Ytd_is_history_Tmr_is_a_mystery!</code>. Lúc này mình thử test trên powershell thì ra được thông báo dưới đây:</p>


  

<figure><img src="/blog/coconut-ascis-ctf-2022/ASCIScoconut_img/photo_2022-10-21_13-33-41.jpg"
    alt="Mô tả hình ảnh" width="1000">
</figure>


<p>Tuy nhiên trong lúc chạy thì file <code>PANDA.png</code> đã được dump ra:</p>


  

<figure><img src="/blog/coconut-ascis-ctf-2022/ASCIScoconut_img/PANDA.png"
    alt="Mô tả hình ảnh" width="1000">
</figure>


<p>Như vậy mình đã có được 1 phần của flag: <code>ASCIS{7hat's_Why_7h3y_call_it</code>. Tuy nhiên phần còn lại của flag thì mình chưa biết, vì cái thông báo trên powershell lúc nãy đã cho mình biết được nhiệm vụ tiếp theo phải bypass được đoạn đó để tìm ra flag còn lại.</p>

<h2 class="relative group">Bypass the Time
    <div id="bypass-the-time" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#bypass-the-time" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Phân tích lại file sau khi đã deobfuscated, sau khi đã decrypt ra file <code>PANDA.jpg</code> bằng thuật toán AES, nó nhảy vào hàm <code>coconut_06</code> và tới hàm <code>coconut_60</code>:</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">coconut_60</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span> <span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="n">Year</span> <span class="p">&lt;</span> <span class="m">3022</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Waiting for a thousand year.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">Thread</span><span class="p">.</span><span class="n">Sleep</span><span class="p">(</span><span class="m">86400000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Coconut</span><span class="p">.</span><span class="n">coconut_36</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p>Đoạn check chỉ kiểm tra năm hiện tại trên máy tính có lớn hơn 3022 hay không, ngược lại nó sẽ nhảy vào vòng lặp &ldquo;vô tận&rdquo;. Để pass nó, bạn đọc có thể edit lại method và sửa dấu <code>&lt;</code> thành <code>&gt;</code>. Lưu lại và chạy file đã patched.</p>


  

<figure><img src="/blog/coconut-ascis-ctf-2022/ASCIScoconut_img/photo_2022-10-21_14-31-06.jpg"
    alt="Mô tả hình ảnh" width="1000">
</figure>


<p>Lần này mình đã dump ra được file <code>DRAGON_WARRIOR.png</code>, nhưng có gì đó không đúng&hellip;.</p>
<p>Debug qua đoạn dump ra file <code>DRAGON_WARRIOR.png</code> cụ thể ở đây là hàm <code>coconut_16</code>, mình thấy nó in ra key: <code>Void coconut_63()System.String coconut_16()</code></p>


  

<figure><img src="/blog/coconut-ascis-ctf-2022/ASCIScoconut_img/photo_2022-10-21_14-52-32.jpg"
    alt="Mô tả hình ảnh" width="1000">
</figure>


<p>Phân tích hàm <code>coconut_61</code>, nó đang lấy Frame dựa trên stackTrace để lấy tên hàm con thuộc <code>coconut_61</code>,trong trường hợp này là hàm <code>coconut_61</code> và <code>coconut_63</code>. Cho nên mới có kết quả khi return cái key trên. Tuy nhiên, key đó không đúng vì lúc nãy mình đã chạy thử file patched trước đó.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">coconut_61</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">StackTrace</span> <span class="n">stackTrace</span> <span class="p">=</span> <span class="k">new</span> <span class="n">StackTrace</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">stackTrace</span><span class="p">.</span><span class="n">GetFrame</span><span class="p">(</span><span class="m">2</span><span class="p">).</span><span class="n">GetMethod</span><span class="p">().</span><span class="n">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="n">stackTrace</span><span class="p">.</span><span class="n">GetFrame</span><span class="p">(</span><span class="m">1</span><span class="p">).</span><span class="n">GetMethod</span><span class="p">().</span><span class="n">ToString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p><strong>Vậy vấn đề ở đây là gì ?</strong></p>
<p>Quay trở lại hàm <code>coconut_36</code>, try-catch sẽ thực hiện nhảy vào hàm <code>coconut_63</code>, nếu như hàm đó không bị lỗi và ngược lại nó sẽ nhảy vào hàm <code>coconut_25</code>. Vấn đề là khi trace tới <code>coconut_63</code> nó không bị lỗi bởi vì mình đã deobfuscate hàm đó rồi. Đó chính là mấu chốt của bài toán trên, vì vậy mình buộc phải trace vào hàm <code>coconut_25</code> thì mới return về key đúng.</p>
<p>**Giải pháp:**Chuyển số 3022 ra dạng hexadecimal ta được <code>0x0bce</code>, tức là <code>206 và 11</code>. Đồng thời mở file Coconut.exe ban đầu (chưa modified gì hết), ta lấy tất cả bytes của <code>water06</code>:</p>


  

<figure><img src="/blog/coconut-ascis-ctf-2022/ASCIScoconut_img/photo_2022-10-21_15-33-39.jpg"
    alt="Mô tả hình ảnh" width="1000">
</figure>


<p>Tìm số 206 và 11, mình thấy nó nằm trong mảng <code>water06</code>. Pattern đó chính là số 3022 thuộc đoạn <code>while (DateTime.Now.Year &gt; 3022)</code>, mình có thể thay số 3022 thành số nào nhỏ hơn năm hiện tại trên máy (ở đây là năm 2022), ở đây mình sẽ dùng số <code>2019</code> tức là <code>227 07</code> dưới dạng bytearray. Sau đó patch 2 số đó vào vị trí của số <code>206 và 11</code>.</p>
<ul>
<li><code>water06</code> sau khi được modified:</li>
</ul>


  

<figure><img src="/blog/coconut-ascis-ctf-2022/ASCIScoconut_img/photo_2022-10-21_15-40-44.jpg"
    alt="Mô tả hình ảnh" width="1000">
</figure>


<p>Cuối cùng, chạy file sau khi sửa, ta đã thành công dump được file <code>DRAGON_WARRIOR.png</code>:</p>


  

<figure><img src="/blog/coconut-ascis-ctf-2022/ASCIScoconut_img/DRAGON%20WARRIOR.png"
    alt="Mô tả hình ảnh" width="1000">
</figure>


<p>Flag thứ 2: <code>_Prrrres3nt!!!!}</code></p>
<p>Ghép lại flag1 và flag2, ta được 1 flag hoàn chỉnh: <code>ASCIS{7hat's_Why_7h3y_call_it_Prrrres3nt!!!!}</code>
Full script solve mình để ở đây: <a href="https://github.com/MrEn1gma/Writeups/blob/main/ASCIS/2022/Coconut/solve.py"  target="_blank">solve</a></p>

<h2 class="relative group">END
    <div id="end" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#end" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Hết rồi =)))</p>

          
          
          
        </div>
        
        

        

        
  <p>Related content:</p>
  <ul>
    
      <li><a href="/blog/my-first-post/">My first blog</a></li>
    
  </ul>

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_blog\Coconut ASCIS CTF 2022\index.md"
          data-oid-likes="likes_blog\Coconut ASCIS CTF 2022\index.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span class="flex flex-col">
          
            <a
              class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/blog/my-first-post/">
              <span class="leading-6">
                <span class="inline-block rtl:rotate-180">&larr;</span>&ensp;My first blog
              </span>
            </a>
            
              <span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2022-10-18T20:00:00&#43;07:00">18 October 2022</time>
              </span>
            
          
        </span>
        <span class="flex flex-col items-end">
          
            <a
              class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/blog/malwareanalysis-holactf-2025/">
              <span class="leading-6">
                MalwareAnalysis - HolaCTF 2025&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
              </span>
            </a>
            
              <span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2025-11-30T20:00:00&#43;07:00">30 November 2025</time>
              </span>
            
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2026
          MrEn1gma
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="https://thehiddenwikiii.github.io/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
